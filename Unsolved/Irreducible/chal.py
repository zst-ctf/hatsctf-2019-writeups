from secret import flag
from os import urandom
from gmpy2 import next_prime

k = 8

n = next_prime(int(urandom(256).encode('hex'),16))*next_prime(int(urandom(256).encode('hex'),16))

a = [int(urandom(256).encode('hex'),16) for _ in range(k)]

flag = int(flag.encode('hex'),16)

enc = 0

for i in range(k):
    enc = (enc + a[i] * pow(flag,i,n))%n

print 'n = '+str(n)
print 'a = '+str(a)
print 'enc = '+str(enc)

'''
n = 634390332758544863533225908175278820293902247273694738557279808547507605605243060845779162007453421166537998974798267403165147194326220277087481586732434578483984382044909938217885300325454854003592061285530227347443870161489884108156839152026792175883344824312705039432192788282221751953071400637582212565973825187901493157747810534534782538666139623239849108114074769483176190409077525619642607096659163938064917619080979276653346570460907840530820984090762890328670108372635266804760702260308210468824054785225609704744553702749030883759302514419732475353237265623064175672626973021817721830057157554469942016659636665088355223388001385492075532645512044699024856214047179824353294265985131421311264905683919868689468128201121500051333234294495133322269575003178917846613019513055294938676473347834648859092781820455177396655659241350758080943209448657069860156330266182595425071785597749584755392149850520201502359380960953028168070443739303437501159547492090284199748847031233395048565256094155871209024910665765470210489150199890408963339584734607161548145948117870587381417761820782604845894085527393326561552255285252183775565605213613851508658068982312542266745844181179298681513229587620814341358546533028653639404063795287
a = [2010531849014807811244967452550596954170482017366963197179967378341950609877035976926266565045201327954545531976193764010455839462214548125935809831930906217583985144556304000068160287029349520299624614834820614980577571769037952453503904780829945902428777023113240343971798255994725602060032080395165249252118203994597989803323008689445738726958316299382843046151379404223038378306103446946814242282508452762994709381767737020005234626341549245619459606877141219867068035139077696570326679785895561991386159948678734295510819110097778649467477026525304571866935401916133281154191128385628924010309987916939562860944L, 1957728714073561025444049862451037169274105569943303306791307265284902155776766730138921929047515116875064204422846355574659846986380481554081304450196740182791655899138238300809181952819798719334682652843468093290967739253183715122445807216087701696532328794077633906535348772595420658664669631932240904104526705654085471965081124710424408313188658654269997323823344665013620792807904922448804892707022585395887233208782695904651548515039238103159738011670910000843881190838705734405508263817080572349269917899711814025839567038759017324204719274094925235488251139390100879986034431576582233053100042459754056721328L, 14633594144788739927026894977043979066159638374614447093714156045032057824085101117749372536628815108406925045960292833889218109370315352739477423094983344593380872607721265115065643999704623781354837795392356213963728183408707784710730841593835763297179871187214115888599867994386663070192739880387913810433876985756438937656886777305157527713862265106976080853776807701851418468867892514187995330270398511480196219270778795626752449173027453951938908052889586748615014028198921819259360961682079672852871334097972121537195761276233238326097040304123395264448294169902168081701555285410252628418576329612032743822656L, 30929744237761925275779619637228756909273275228972750977833842275681869086116340969076439846499218017534226291524942385308707563078786626236494596208894970526069269519418649985914398929328741202595762382734225557440059310318524491309260192804536315362985304213401749160044798809875645571955587602983295393590560174552439433974878741218152614497192789702930801977104493818899157936635075060547744352678118768665244767760543756729845753210746035948226910923229144631648461693219879044167508144465542745778725708145285938143335905860453429086530916135708582690647044249742625720553034307280926958493635056715199618948255L, 2736997387699905351668085980997857573537883215020849824031924382478774724354893995582443335957215604292871013310245658357276267388909986882514451123356268477738475383061844694003338924573791710273211430026022500105647755368859353564374828513889089668535501312143014776864228173945699898966966038577097286471416334498369191331733489012787167892563032372216318024758127709506640721164446544052940686946306349794324428219841864315805616481940362854692253412646097863219862500643764207829111058334685461395519153197770408604824434255674531095991762385404626964401461278191533996440553437636464337965673618849007875748335L, 10138853565592015105460349391824630041349301782955976098151452306601942132992939175760470023847252810478352651882007892229451212768112510921391523329570278170494870876172217466315580044877833446334271653752234487178668899095662633037386537755400120340774679512511394968940579253203708322989582269535699783805149252869744882348496667131258430507421739826457730921423784937910140043747774058768492858149057261161659337718982175323365787375263797780804084574556765866310528969548165524609215368165479974192219642551585795556561156118984108183820103401463673813278192939446726782671210175154550709092578352646292397148695L, 2705289074015868556495876116122034778419482000649816956762698090011178447945290332666191814319874892445968692874942151089591538419047230200250130537360543283500874358388021915731700617342644182770696524538105308332591350174568506946526824286428046901094088052777906597555877816895182575842954717583238668932627003103765051957703661539717838484368046549711819678603390137497777321547780661184734527888712946398571068227748473417068659665911823063293642880605380887346392751759275385749252422803713137333278390979373269487140753614904363290566511431042967664299521308911436294095767853420126884677960454179566849947911L, 32255664078313921987277419379096806499011603256554039416290254881793020312519926307527921519979634759557831587219841583766017314943677339008869153819229665461685884451017771930587031347299979562059056085002308162520099267712782084503108260647689403237182131017247206190667209194033633402951334606382904942572174996868542183284017683810713524436317515257997599861313148353141712577673062302740163653303306191436502370962209436722553506417051271738096885658139454947332529520834452755246989316977226513412490778345898961230442523579466541698292139280562767818413666760816022286886124820077034842996907566401674181684192L]
enc = 340380243606881896055357150852081704009261841875676917168392901542600158697498147470022070926431538973355986319287899336229347984195186235609026994105880539538744385947844002522392600799291123746788307149592202054293542184751426393921386667054337702133605244653857105200184382184314615395089410386837949991463800365032817120047755695213056898358351029050988904465534196504370647057949656041980136093701111673261061362088910159060407069111138148213911184934346030355108818623873406179170643354109575921906069827319176721391148784597815966696725312993112836679580986301915869285153640258800257520387666039815335882682501846764931914005501272890703979399028303286591392295335090668894416007738581234420317705017602185505796952708538056986900927227219010924990687749054202059611121098007196600311153002496535400678852675523633611129751070279014895782742719230859241266618078080591783496208454660896116326742901368549176280950824427940866633550004165659591555809355785250595678271198087444
'''

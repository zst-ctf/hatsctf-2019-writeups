from secret import flag

p = 3222648157761763022765666627526081771965464654735271102975016411514968380582603473685327245591880615139230739580267468459750307042925863983751432626117
F = Integers(p)

a = F(randint(0,p))
b = F(randint(0,p))

def add(P,Q):
    if P == O:
        return Q
    if Q == O:
        return P
    if P[0]==Q[0] and P[1]==Q[1]:
        l = (3*P[0]^2 + 4*b*P[0] + b^2)/(2*P[1] + 2*a)
    elif P[0]==Q[0]:
        return O
    else:
        l = (P[1] - Q[1])/(P[0] - Q[0])
    x = l^2 - 2*b - P[0] - Q[0]
    y = l*P[0] - 2*a - l*x - P[1]
    return (x,y)

def mul(P, n):
    if n == 0:
        return O
    if n == 1:
        return P
    if n%2 == 0:
        P = mul(P, n/2)
        return add(P, P)
    return add(mul(P, n-1), P)

def genpt():
    # removed

G = genpt()

H = mul(G,flag)

print "a = ",a
print "b = ",b
print "G = ",G
print "H = ",H
'''
a =  487320905246514996710882345135044871121512008237324170012832956924099792187540111460289912841726146244052980994686224403733605604797574545446413363085
b =  891150102340757904253323224280187690215443182646114447345589520678504447038359547177123014086693784493499556623169950335070623909489328924914931079385
G =  (2104329886347020236988353035966018948895884440835873927220509828281578294905534908501819771688826148463264706747608174635897075544044151799369074522293L, 547539313304824346468016104211543548758390954042222580390577379575954748088186706546832760968012782250222822932766795878310674456147870885251541155129)
C =  (1372080776377718132103580573250223575813563729090936999426778086693588513088976978436348386875498733256960009237843675811430600305388144802989181423070, 1226837805973980837527822038751322812365918337743740867865572278640254983537702985917434056395578799418328688965000006513157019132052408854706352039810)
'''
